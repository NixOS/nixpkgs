Subject: [PATCH] Compile transupp.c as part of the library
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -615,7 +615,7 @@
   src/jcparam.c src/jcphuff.c src/jctrans.c src/jdapimin.c src/jdatadst.c
   src/jdatasrc.c src/jdhuff.c src/jdicc.c src/jdinput.c src/jdlhuff.c
   src/jdmarker.c src/jdmaster.c src/jdphuff.c src/jdtrans.c src/jerror.c
-  src/jfdctflt.c src/jmemmgr.c src/jmemnobs.c src/jpeg_nbits.c)
+  src/jfdctflt.c src/jmemmgr.c src/jmemnobs.c src/jpeg_nbits.c src/transupp.c)
 
 if(WITH_ARITH_ENC OR WITH_ARITH_DEC)
   set(JPEG_SOURCES ${JPEG_SOURCES} src/jaricom.c)
@@ -2066,7 +2066,7 @@
 install(FILES ${CMAKE_CURRENT_BINARY_DIR}/jconfig.h
   ${CMAKE_CURRENT_SOURCE_DIR}/src/jerror.h
   ${CMAKE_CURRENT_SOURCE_DIR}/src/jmorecfg.h
-  ${CMAKE_CURRENT_SOURCE_DIR}/src/jpeglib.h
+  ${CMAKE_CURRENT_SOURCE_DIR}/src/jpeglib.h ${CMAKE_CURRENT_SOURCE_DIR}/src/transupp.h
   DESTINATION ${CMAKE_INSTALL_INCLUDEDIR} COMPONENT include)
 
 include(cmakescripts/BuildPackages.cmake)
