From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: Paul Meyer <49727155+katexochen@users.noreply.github.com>
Date: Mon, 22 Apr 2024 11:59:22 +0200
Subject: [PATCH] nixpkgs: use system C/C++ toolchains

Signed-off-by: Paul Meyer <49727155+katexochen@users.noreply.github.com>
Signed-off-by: Luke Granger-Brown <git@lukegb.com>
---
 bazel/dependency_imports.bzl | 6 +++++-
 1 file changed, 5 insertions(+), 1 deletion(-)

diff --git a/bazel/dependency_imports.bzl b/bazel/dependency_imports.bzl
index ce827807be8cae1833026aae632e01e91bfea40d..cc8431aa48c45433b0477841b0707ed9fc02b81d 100644
--- a/bazel/dependency_imports.bzl
+++ b/bazel/dependency_imports.bzl
@@ -40,7 +40,11 @@ def envoy_dependency_imports(
         buf_sha = BUF_SHA,
         buf_version = BUF_VERSION):
     compatibility_proxy_repo()
-    rules_foreign_cc_dependencies()
+    rules_foreign_cc_dependencies(
+        register_default_tools=False,  # no prebuilt toolchains
+        register_built_tools=False,  # nor from source
+        register_preinstalled_tools=True,  # use host tools (default)
+    )
     go_rules_dependencies()
     go_register_toolchains(go_version)
     if go_version != "host":
