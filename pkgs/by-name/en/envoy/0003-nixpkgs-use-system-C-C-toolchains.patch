From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: Paul Meyer <49727155+katexochen@users.noreply.github.com>
Date: Mon, 22 Apr 2024 11:59:22 +0200
Subject: [PATCH] nixpkgs: use system C/C++ toolchains

Signed-off-by: Paul Meyer <49727155+katexochen@users.noreply.github.com>
Signed-off-by: Luke Granger-Brown <git@lukegb.com>
---
 bazel/dependency_imports.bzl | 6 +++++-
 1 file changed, 5 insertions(+), 1 deletion(-)

diff --git a/bazel/dependency_imports.bzl b/bazel/dependency_imports.bzl
index 10be4b0b3f65e486c1dc8419337a5cf823431774..b0badb3ccab3b112043bd8616770f8014238d396 100644
--- a/bazel/dependency_imports.bzl
+++ b/bazel/dependency_imports.bzl
@@ -38,7 +38,11 @@ def envoy_dependency_imports(
         yq_version = YQ_VERSION,
         buf_sha = BUF_SHA,
         buf_version = BUF_VERSION):
-    rules_foreign_cc_dependencies()
+    rules_foreign_cc_dependencies(
+        register_default_tools=False,  # no prebuilt toolchains
+        register_built_tools=False,  # nor from source
+        register_preinstalled_tools=True,  # use host tools (default)
+    )
     go_rules_dependencies()
     go_register_toolchains(go_version)
     if go_version != "host":
