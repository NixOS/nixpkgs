commit e6f53948cd203e5f66f660474162ba2f01f1b3dc
Author: Thomas LÃ¼bking <thomas.luebking@gmail.com>
Date:   Mon Nov 8 15:24:11 2021 +0100

    attempted Qt6 fix

diff --git a/Qarma.cpp b/Qarma.cpp
index bab600e..63abc32 100644
--- a/Qarma.cpp
+++ b/Qarma.cpp
@@ -28,7 +28,6 @@
 #include <QDBusConnection>
 #include <QDBusConnectionInterface>
 #include <QDBusInterface>
-#include <QDesktopWidget>
 #include <QDialogButtonBox>
 #include <QEvent>
 #include <QFileDialog>
@@ -156,7 +155,11 @@ private:
 InputGuard *InputGuard::s_instance = NULL;
 
 #ifdef WS_X11
+#if (QT_VERSION >= QT_VERSION_CHECK(6, 0, 0))
+#include <QX11Application>
+#else
 #include <QX11Info>
+#endif
 #include <X11/Xlib.h>
 #endif
 
@@ -345,7 +348,13 @@ Qarma::Qarma(int &argc, char **argv) : QApplication(argc, argv)
         if (m_parentWindow) {
 #ifdef WS_X11
             m_dialog->setAttribute(Qt::WA_X11BypassTransientForHint);
-            XSetTransientForHint(QX11Info::display(), m_dialog->winId(), m_parentWindow);
+            Display *dpy;
+#if (QT_VERSION >= QT_VERSION_CHECK(6, 0, 0))
+            dpy = QGuiApplication::nativeInterface<QX11Application*>()->display();
+#else
+            dpy = QX11Info::display();
+#endif
+            XSetTransientForHint(dpy, m_dialog->winId(), m_parentWindow);
 #endif
         }
     }
diff --git a/qarma.pro b/qarma.pro
index 33da748..56a7bc2 100644
--- a/qarma.pro
+++ b/qarma.pro
@@ -1,7 +1,9 @@
 HEADERS = Qarma.h
 SOURCES = Qarma.cpp
 QT      += dbus gui widgets
-unix:!macx:QT += x11extras
+lessThan(QT_MAJOR_VERSION, 6){
+  unix:!macx:QT += x11extras
+}
 TARGET  = qarma
 
 unix:!macx:LIBS    += -lX11
