diff -uprN a/compiler/main/Packages.lhs b/compiler/main/Packages.lhs
--- a/compiler/main/Packages.lhs
+++ b/compiler/main/Packages.lhs
@@ -207,7 +207,12 @@ readPackageConfigs dflags = do
   liftM concat $ mapM (readPackageConfig dflags) confs
 
 resolvePackageConfig :: DynFlags -> PkgConfRef -> IO (Maybe FilePath)
-resolvePackageConfig dflags GlobalPkgConf = return $ Just (systemPackageConfig dflags)
+resolvePackageConfig dflags GlobalPkgConf = do
+  e_nix_pkg_path <- tryIO (getEnv "NIX_GHC_PACKAGE_PATH")
+  let nix_pkg_path = case e_nix_pkg_path of
+        Left _ -> Just (systemPackageConfig dflags)
+        Right path -> Just path
+  return nix_pkg_path
 resolvePackageConfig _ UserPkgConf = handleIO (\_ -> return Nothing) $ do
   appdir <- getAppUserDataDirectory "ghc"
   let dir = appdir </> (TARGET_ARCH ++ '-':TARGET_OS ++ '-':cProjectVersion)
diff -uprN a/utils/ghc-pkg/ghc-pkg.wrapper b/utils/ghc-pkg/ghc-pkg.wrapper
--- a/utils/ghc-pkg/ghc-pkg.wrapper
+++ b/utils/ghc-pkg/ghc-pkg.wrapper
@@ -1,5 +1,10 @@
 #!/bin/sh
 
-PKGCONF="$topdir/package.conf.d"
+if [ -z $NIX_GHC_PACKAGE_PATH ]; then
+  PKGCONF="$topdir/package.conf.d"
+else
+  PKGCONF="$NIX_GHC_PACKAGE_PATH"
+fi
+
 exec "$executablename" --global-package-db "$PKGCONF" ${1+"$@"}
 
